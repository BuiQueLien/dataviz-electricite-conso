<!DOCTYPE HTML>
<!--
	Overflow by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Projet DataViz</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<script src="https://d3js.org/d3.v4.min.js"></script>
	</head>
	<body class="is-preload">

		<!-- Header -->
			<section id="header">
				<header>
					<h1>La consommation d'éléctricité en France</h1>
				</br><p style="font-size: smaller;">Data Visualisation <br>M2 2019-2020<br> Departement Informatique <br>Université Claude Bernard Lyon 1</p>
				<br />
				<h4>Réalisé par : Lien Que BUI, Oreste GAFILIGI, Minh Luan HOA, et Nour MEDJEDEL</h4>
				</header>
				<footer>
					<a href="#banner" class="button style2 scrolly-middle">Commencer</a>
				</footer>
			</section>

		<!-- Banner -->
			<section id="banner">
				<header>
					<h2>Objectif</h2>
				</header>
				<p>Visualiser  
					la consommation de l'éléctricité
					aux foyers français de 2007 jusqu'à 2010</p>
				<footer>
					<a href="#first" class="button style2 scrolly">Plus de détails</a>
				</footer>
			</section>

		<!-- Feature 1 -->
			<article id="first" class="container box style1 right">
				<a href="#" class="image fit"><img src="images/img1.jpg" alt="" /></a>
				<div class="inner" style="position: inherit;">
					<header>
						<h3>Contextualisation & Données</h3>
						<p style="font-size: smaller;">La consommation domestique d’électricité par habitant a presque doublé en France en l’espace de 30 ans : elle est passée de 4 MWh / habitant en 1982 à 6,7 MWh / habitant en 2012, ce qui correspond à une augmentation annuelle moyenne de l’ordre de +1,7 % / an.
							<br>Cette hausse est principalement liée à la multiplication des usages spécifiques de l’électricité, représentés par les nouvelles technologies de l’information et de la communication (informatique, hifi, consoles de jeux, etc.), mais aussi au développement de 
							l’utilisation de chauffages électriques et des procédés de production fonctionnant à l’électricité.<a href="https://observatoire-electricite.fr/analyses-de-donnees/Evolution-de-la-consommation">(source)</a></p>
					</header>
					<p><b>Les données utilisées dans ce projet : </b></p>
						<ul class="default">
							<li><a href = "http://www.daftlogic.com/information-appliance-power-consumption.htm?fbclid=IwAR2CprTK17Buto7s2V6oMBbvR0rHNA32VXZsre3OrihzcxDb7S_wHO3A8HQ"> List of the Power Consumption of Typical Household Appliances (DaftLogic)</a> </li>
							<li><a href="http://archive.ics.uci.edu/ml/datasets/individual+household+electric+power+consumption">Household electric power consumption Data Set (Archives UCI) </a> </li> 
						</ul >
				</div>
			</article>


			<!-- Portfolio -->
			<article class="container box style2">
				<header>
					<h2>Concept de la Visualisation</h2>
					<p>Les graphes proposents une Line Chart pour chaque consommation en Wh des différentes pièces. Ainsi qu'un Pie Chart récapitulatif.</p><br>
					<p style="font-size: smaller;">Cuisine:(en watt-hour) : contient principalement un lave-vaisselle, un four et un micro-onde (les plaques ne sont pas électrique mais au gaz)<br>

						Laverie: (en watt-hour) : contient le lave-linge, un sèche linge, un refrigirateur et une lampe. <br>
						Climatiseur: (en watt-hour) : contient un chauffe eau et un climatiseur.</p>
					
				</header>
				
				<!--
				<div class="inner gallery">
					<div class="row gtr-0">
						<div class="col-3 col-12-mobile"><a href="images/fulls/01.jpg" class="image fit"><img src="images/thumbs/01.jpg" alt="" title="Ad infinitum" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/02.jpg" class="image fit"><img src="images/thumbs/02.jpg" alt="" title="Dressed in Clarity" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/03.jpg" class="image fit"><img src="images/thumbs/03.jpg" alt="" title="Raven" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/04.jpg" class="image fit"><img src="images/thumbs/04.jpg" alt="" title="I'll have a cup of Disneyland, please" /></a></div>
					</div>
					<div class="row gtr-0">
						<div class="col-3 col-12-mobile"><a href="images/fulls/05.jpg" class="image fit"><img src="images/thumbs/05.jpg" alt="" title="Cherish" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/06.jpg" class="image fit"><img src="images/thumbs/06.jpg" alt="" title="Different." /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/07.jpg" class="image fit"><img src="images/thumbs/07.jpg" alt="" title="History was made here" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/08.jpg" class="image fit"><img src="images/thumbs/08.jpg" alt="" title="People come and go and walk away" /></a></div>
					</div>
				</div>
				-->
			</article>
				
			<article class="container box style3">
				<section>
					<header>
						<h3>consommation moyenne par an</h3>
					</header>
					<div>
						<select id="d3-dropdown" style="">
							<option value="0">2006</option>
							<option value="1">2007</option>
							<option value="2">2008</option>
							<option value="3">2009</option>
							<option value="4">2010</option>
						</select>
					</div>
					<div>
						<hr/>
					</div>
				</section>
			</article>
			<article class="container box style3">
				<section>
					<header>
						<h3>consommation quotidienne</h3>
						<p>Veuillez préciser la date</p>
					</header>
					<div style="display: flex; justify-content: center;"><input id = "date" type="text" name="date" value="1/1/2007" style="height: 30px; width: 130px;"> <br><br></div>	
					<div id="visual" >
							
					</div>
					<div>
						<div style="display: flex; justify-content: center;"></br><input class = "button " name="updateButton" type="button" value="Update" onclick="update()"></div>
						
						<p style="font-size: smaller;"> Ce graphe est particulier. Il represente la consommation quotidienne qui n'appartient pas aux pièces présentées. Soit la consommation quotidienne globale de la maison soustraite aux trois pièces.</p>			
						<hr/>	
					</div>
				</section>
				<section>
					<header>
						<h3>consommation quotidienne</h3>
						<p>Veuillez préciser la date et les pièces</p>
					</header>
					<div style="display: flex; justify-content: center;"><input id = "date2" type="text" name="date" value="1/1/2007" style="height: 30px; width: 130px;">
						<input type="checkbox" id="myCheckbox1"> <label for="myCheckbox1">Cuisine</label>
						<input type="checkbox" id="myCheckbox2"> <label for="myCheckbox2">Laverie</label>
						<input type="checkbox" id="myCheckbox3" Checked> <label for="myCheckbox3">Climatiseur</label>
					</div>	
					<div id="visual2" >
							
					</div>
					<div>
						<div style="display: flex; justify-content: center;"></br><input class = "button " name="updateButton" type="button" value="Update" onclick="update2()"></div>
						<br>
						<p style="font-size: smaller;">Ce graphe représente la consommation quotidienne de chaque pièce (aréas) avec leurs moyennes respectives sur le mois (lines)</p>		
						<hr/>	
					</div>
				</section>
			</article>
			<article class="container box style3">
				<section>
					<header>
						<h3>consommation totale mensuelle</h3>
						<p>Veuillez préciser la date et les pièces</p>
					</header>
					<div style="display: flex; justify-content: center;"><input id = "date3" type="text" name="date" value="1/1/2007" style="height: 30px; width: 130px;">
						<input type="checkbox" id="myCheckbox4"> <label for="myCheckbox4">Cuisine</label>
						<input type="checkbox" id="myCheckbox5"> <label for="myCheckbox5">Laverie</label>
						<input type="checkbox" id="myCheckbox6" Checked> <label for="myCheckbox6">Climatiseur</label>
					</div>	
					<div id="visual3" style="display: flex; justify-content: center;"></div>
					<div>	
						<div style="display: flex; justify-content: center;"></br><input class = "button " name="updateButton" type="button" value="Update" onclick="update3()"></div>
						<br>
					    <p style="font-size: smaller;">Ce graphe représente la consommation mensuelle de chaque pièce (aréas) avec leurs moyennes respectives sur l'année (lines)</p>		
						<hr/>	
					</div>
				</section>
			</article>
			<article class="container box style3">
				<section>
					<header>
						<h3>Consommation moyenne annuelle</h3>
						<p>Veuillez préciser la date et les pièces</p>
					</header>
					<div style="display: flex; justify-content: center;"><input id = "date4" type="text" name="date" value="1/1/2007" style="height: 30px; width: 130px;">
						<input type="checkbox" id="myCheckbox7"> <label for="myCheckbox7">Cuisine</label>
						<input type="checkbox" id="myCheckbox8"> <label for="myCheckbox8">Laverie</label>
						<input type="checkbox" id="myCheckbox9" Checked> <label for="myCheckbox9">Climatiseur</label>
					</div>	
					<div id="visual4" style="display: flex; justify-content: center;" ></div>
					<div>
						<div style="display: flex; justify-content: center;"></br><input class = "button " name="updateButton" type="button" value="Update" onclick="update4()"></div>
						<br>
						<p style="font-size: smaller;"> Ce graphe représente la consommation anuelle de chaque pièce (aréas) avec leurs moyennes respectives sur toutes les années (lines)</p>		
						<hr/>
					</div>
			</article>
			



		<!-- Portfolio -->
		<!--
			<article class="container box style2">
				<header>
					<h2>Magnis parturient</h2>
					<p>Justo phasellus et aenean dignissim<br />
					placerat cubilia purus lectus.</p>
				</header>
				<div class="inner gallery">
					<div class="row gtr-0">
						<div class="col-3 col-12-mobile"><a href="images/fulls/01.jpg" class="image fit"><img src="images/thumbs/01.jpg" alt="" title="Ad infinitum" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/02.jpg" class="image fit"><img src="images/thumbs/02.jpg" alt="" title="Dressed in Clarity" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/03.jpg" class="image fit"><img src="images/thumbs/03.jpg" alt="" title="Raven" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/04.jpg" class="image fit"><img src="images/thumbs/04.jpg" alt="" title="I'll have a cup of Disneyland, please" /></a></div>
					</div>
					<div class="row gtr-0">
						<div class="col-3 col-12-mobile"><a href="images/fulls/05.jpg" class="image fit"><img src="images/thumbs/05.jpg" alt="" title="Cherish" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/06.jpg" class="image fit"><img src="images/thumbs/06.jpg" alt="" title="Different." /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/07.jpg" class="image fit"><img src="images/thumbs/07.jpg" alt="" title="History was made here" /></a></div>
						<div class="col-3 col-12-mobile"><a href="images/fulls/08.jpg" class="image fit"><img src="images/thumbs/08.jpg" alt="" title="People come and go and walk away" /></a></div>
					</div>
				</div>
			</article>
		-->
		<!-- Contact -->
		<!--
			<article class="container box style3">
				<header>
					<h2>Nisl sed ultricies</h2>
					<p>Diam dignissim lectus eu ornare volutpat orci.</p>
				</header>
				<form method="post" action="#">
					<div class="row gtr-50">
						<div class="col-6 col-12-mobile"><input type="text" class="text" name="name" placeholder="Name" /></div>
						<div class="col-6 col-12-mobile"><input type="text" class="text" name="email" placeholder="Email" /></div>
						<div class="col-12">
							<textarea name="message" placeholder="Message"></textarea>
						</div>
						<div class="col-12">
							<ul class="actions">
								<li><input type="submit" value="Send Message" /></li>
							</ul>
						</div>
					</div>
				</form>
			</article>
		-->
		<!-- Generic -->
		<!--
			<article class="container box style3">
				<header>
					<h2>Generic Box</h2>
					<p>Just a generic box. Nothing to see here.</p>
				</header>
				<section>
					<header>
						<h3>Paragraph</h3>
						<p>This is a subtitle</p>
					</header>
					<p>Phasellus nisl nisl, varius id <sup>porttitor sed pellentesque</sup> ac orci. Pellentesque
					habitant <strong>strong</strong> tristique <b>bold</b> et netus <i>italic</i> malesuada <em>emphasized</em> ac turpis egestas. Morbi
					leo suscipit ut. Praesent <sub>id turpis vitae</sub> turpis pretium ultricies. Vestibulum sit
					amet risus elit.</p>
				</section>
				<section>
					<header>
						<h3>Blockquote</h3>
					</header>
					<blockquote>Fringilla nisl. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget.
					tempus euismod. Vestibulum ante ipsum primis in faucibus.</blockquote>
				</section>
				<section>
					<header>
						<h3>Divider</h3>
					</header>
					<p>Donec consectetur <a href="#">vestibulum dolor et pulvinar</a>. Etiam vel felis enim, at viverra
					ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel. Praesent nec orci
					facilisis leo magna. Cras sit amet urna eros, id egestas urna. Quisque aliquam
					tempus euismod. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices
					posuere cubilia.</p>
					<hr />
					<p>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra
					ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel. Praesent nec orci
					facilisis leo magna. Cras sit amet urna eros, id egestas urna. Quisque aliquam
					tempus euismod. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices
					posuere cubilia.</p>
				</section>
				<section>
					<header>
						<h3>Unordered List</h3>
					</header>
					<ul>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
					</ul>
				</section>
				<section>
					<header>
						<h3>Ordered List</h3>
					</header>
					<ol>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
						<li>Donec consectetur vestibulum dolor et pulvinar. Etiam vel felis enim, at viverra ligula. Ut porttitor sagittis lorem, quis eleifend nisi ornare vel.</li>
					</ol>
				</section>
				<section>
					<header>
						<h3>Table</h3>
					</header>
					<div class="table-wrapper">
						<table>
							<thead>
								<tr>
									<th>ID</th>
									<th>Name</th>
									<th>Description</th>
									<th>Price</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>45815</td>
									<td>Something</td>
									<td>Ut porttitor sagittis lorem quis nisi ornare.</td>
									<td>29.99</td>
								</tr>
								<tr>
									<td>24524</td>
									<td>Nothing</td>
									<td>Ut porttitor sagittis lorem quis nisi ornare.</td>
									<td>19.99</td>
								</tr>
								<tr>
									<td>45815</td>
									<td>Something</td>
									<td>Ut porttitor sagittis lorem quis nisi ornare.</td>
									<td>29.99</td>
								</tr>
								<tr>
									<td>24524</td>
									<td>Nothing</td>
									<td>Ut porttitor sagittis lorem quis nisi ornare.</td>
									<td>19.99</td>
								</tr>
							</tbody>
							<tfoot>
								<tr>
									<td colspan="3"></td>
									<td>100.00</td>
								</tr>
							</tfoot>
						</table>
					</div>
				</section>
				<section>
					<header>
						<h3>Form</h3>
					</header>
					<form method="post" action="#">
						<div class="row">
							<div class="col-6 col-12-mobile">
								<input class="text" type="text" name="name" id="name" value="" placeholder="John Doe" />
							</div>
							<div class="col-6 col-12-mobile">
								<input class="text" type="text" name="email" id="email" value="" placeholder="johndoe@domain.tld" />
							</div>
							<div class="col-12">
								<select name="department" id="department">
									<option value="">Choose a department</option>
									<option value="1">Manufacturing</option>
									<option value="2">Administration</option>
									<option value="3">Support</option>
								</select>
							</div>
							<div class="col-12">
								<input class="text" type="text" name="subject" id="subject" value="" placeholder="Enter your subject" />
							</div>
							<div class="col-12">
								<textarea name="message" id="message" placeholder="Enter your message"></textarea>
							</div>
							<div class="col-12">
								<ul class="actions">
									<li><input type="submit" value="Submit" /></li>
									<li><input type="reset" class="style3" value="Clear Form" /></li>
								</ul>
							</div>
						</div>
					</form>
				</section>
			</article>
		-->

		<section id="footer">
			<ul class="icons">
				<li><a href="https://github.com/hoaluan97/dataviz-electricite-conso" class="icon brands fa-github"><span class="label">Github</span>Github</a></li>

			</ul>
			<div class="copyright">
				<ul class="menu">
					<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
				</ul>
			</div>
		</section>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.poptrox.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
				// https://www.d3-graph-gallery.com/graph/area_lineDot.html
				// set the dimensions and margins of the graph
				var margin = {top: 10, right: 30, bottom: 30, left: 60},
					width = 860 - margin.left - margin.right,
					height = 400 - margin.top - margin.bottom;
				
				var dateUpdate = "1/1/2007"
				
				update()
					
				function update(){
				  var dateUpdate = document.getElementById("date").value
				  d3.select("#visual").selectAll("*").remove();
				// append the svg object to the body of the page
					var svg = d3.select("#visual")
				  .append("svg")
					.attr("width", width + margin.left + margin.right)
					.attr("height", height + margin.top + margin.bottom)
				  .append("g")
					.attr("transform",
						  "translate(" + margin.left + "," + margin.top + ")");
				//Read the data
				  d3.csv("https://raw.githubusercontent.com/hoaluan97/dataviz-electricite-conso/master/Individual_Household_Electric_Power_Consumption.csv",
			
					// When reading the csv, I must format variables:
					function(d){
			
					  if(d.Date==dateUpdate){
						return { Date : d3.timeParse("%d/%m/%Y")(d.Date),
								Time : d3.timeParse("%H:%M:%S")(d.Time),
								date : d3.timeParse("%d/%m/%Y %H:%M:%S")(d.Date +" "+ d.Time),
								Global_active_power : d.Global_active_power,
								Sub_metering_1 : d.Sub_metering_1,
								Sub_metering_2 : d.Sub_metering_2,
								Sub_metering_3 : d.Sub_metering_3,
								Sub_metering_other : d.Sub_metering_other }
						}
					},
			
					// Now I can use this dataset:
					function(data) {
					  // Add X axis --> it is a date format
					  console.log(data.length)
					  // This allows to find the closest X index of the mouse:
							  var bisect = d3.bisector(function(d) { return d.date; }).left;
					
						var focus = svg.append('g')
						.append('circle')
						.style("fill", "#47ff6f")
						.attr("stroke", "black")
						.attr('r', 8.5)
						.style("opacity", 0)
					  
					  var focusText = svg.append('g')
						  .append('text')
						.style("opacity", 0)
						.attr("text-anchor", "left")
						.attr("alignment-baseline", "middle")
					  
					  
					  
					  
					  var x = d3.scaleTime()
						.domain(d3.extent(data, function(d) { return d.date; }))
						.range([ 0, width ]);
			
					  xAxis = svg.append("g")
						.attr("transform", "translate(0," + height + ")")
						.call(d3.axisBottom(x));
			
					  // Add Y axis
					  var y = d3.scaleLinear()
						.domain([0, d3.max(data, function(d) { return +d.Sub_metering_other; })])
						.range([ height, 0 ]);
					  yAxis = svg.append("g")
						.call(d3.axisLeft(y));
			
					  // Add a clipPath: everything out of this area won't be drawn.
					  var clip = svg.append("defs").append("svg:clipPath")
						  .attr("id", "clip")
						  .append("svg:rect")
						  .attr("width", width )
						  .attr("height", height )
						  .attr("x", 0)
						  .attr("y", 0)
								.on('mouseover', mouseover)
						  .on('mousemove', mousemove)
						  .on('mouseout', mouseout);
			
					  // Add brushing
					  var brush = d3.brushX()                
						  .extent( [ [0,0], [width,height] ] ) 
						  .on("end", updateChart)
			
					  
					  
					  // Create the line variable: where both the line and the brush take place
					  var line = svg.append('g')
						.attr("clip-path", "url(#clip)")
						  .on('mouseover', mouseover)
						.on('mousemove', mousemove)
						.on('mouseout', mouseout);
								
					  // Add the line
					  var areaGenerator = d3.area()
					  .x(function(d) { return x(d.date) })
					  .y0(y(0))
					  .y1(function(d) { return y(d.Sub_metering_other) })
					  line.append("path")
						.datum(data)
						.attr("class", "line")/*
						.attr("fill", "none")
						.attr("stroke", "steelblue")
						.attr("stroke-width", 1.5)
						.attr("d", d3.line()
						  .x(function(d, i) { return x(d.date) })
						  .y(function(d) { return y(d.Sub_metering_other) })
						  )*/
						  .attr("fill", "#23c4fe")
						.attr("fill-opacity", .3)
						.attr("stroke", "#006c93")
						.attr("stroke-width", 2)
						  
						  .attr("d", areaGenerator)
					  
								
					  
					  
					  line.selectAll("myCircles")
					  .data(data)
					  .enter()
					  .append("circle")
					  .attr("class", "circle")
					  .attr("fill", "red")
					  .attr("stroke", "none")
					  .attr("cx", function(d) { return x(d.date) })
					  .attr("cy", function(d) { return y(d.Sub_metering_other) })
					  .attr("r", 1)
			
					  // Add the brushing
					  line
						.append("g")
						  .attr("class", "brush")
						  .call(brush);
			
					  // A function that set idleTimeOut to null
					  var idleTimeout
					  function idled() { idleTimeout = null; }
					
						  // What happens when the mouse move -> show the annotations at the right positions.
					  function mouseover() {
						focus.style("opacity", 1)
						focusText.style("opacity",1)
					  }
			
					  function mousemove() {
						// recover coordinate we need
						var x0 = x.invert(d3.mouse(this)[0]);
						var i = bisect(data, x0, 1);
						selectedData = data[i]
						focus
						  .attr("cx", x(selectedData.date))
						  .attr("cy", y(selectedData.Sub_metering_other))
						focusText
						  .html("x:" + d3.timeFormat("%H:%M:%S")(selectedData.Time )+ "  -  " + "y:" + selectedData.Sub_metering_other)
						  .attr("x", x(selectedData.date)+15)
						  .attr("y", y(selectedData.Sub_metering_other))
						}
					  function mouseout() {
						focus.style("opacity", 0)
						focusText.style("opacity", 0)
					  }
			
					  // A function that update the chart for given boundaries
					  function updateChart() {
						
						line.selectAll('.circle').remove()
									console.log(xAxis)
						// What are the selected boundaries?
						extent = d3.event.selection
			
						// If no selection, back to initial coordinate. Otherwise, update X axis domain
						if(!extent){
						  if (!idleTimeout) return idleTimeout = setTimeout(idled, 350); // This allows to wait a little bit
						  x.domain([ 4,8])
						}else{
						  x.domain([ x.invert(extent[0]), x.invert(extent[1]) ])
						  line.select(".brush").call(brush.move, null) 
						}
			
						// Update axis and line position
						xAxis.transition().duration(1000).call(d3.axisBottom(x))
						line.select('.line')
							.transition()
							.duration(1000)
							.attr("d", areaGenerator)
						line.selectAll("myCircles")
						  .data(data)
						  .enter()
						  .append("circle")
						  .attr("class", "circle")
						  .attr("fill", "red")
						  .attr("stroke", "none")
						  .attr("cx", function(d) { return x(d.date) })
						  .attr("cy", function(d) { return y(d.Sub_metering_other) })
						  .attr("r", 2)
					  }
			
					  // If user double click, reinitialize the chart
					  svg.on("dblclick",function(){
						x.domain(d3.extent(data, function(d) { return d.date; }))
						xAxis.transition().call(d3.axisBottom(x))
						line.select('.line')
						  .transition()
						  .attr("d", areaGenerator)
						line.selectAll("myCircles")
						  .data(data)
						  .enter()
						  .append("circle")
						  .attr("class", "circle")
						  .attr("fill", "red")
						  .attr("stroke", "none")
						  .attr("cx", function(d) { return x(d.date) })
						  .attr("cy", function(d) { return y(d.Sub_metering_other) })
						  .attr("r", 2)
						
					  });
			
				  })
				}
			
			
			  </script>
			  <script>
		var margin = {top: 10, right: 30, bottom: 30, left: 60},
					width = 860 - margin.left - margin.right,
					height = 400 - margin.top - margin.bottom;
		
			  
		  var dateUpdate = "1/1/2007"
		  d3.select("#myCheckbox1").on("change",check);
		  d3.select("#myCheckbox2").on("change",check);
		  d3.select("#myCheckbox3").on("change",check);
		  var checkline1 = 0
		  var checkline2 = 0
		  var checkline3 = 1
		  function check(){
			if(d3.select("#myCheckbox1").property("checked")){
						  checkline1 = 1
					  } else {
						  checkline1 = 0
					  }
			if(d3.select("#myCheckbox2").property("checked")){
						  checkline2 = 1
					  } else {
						  checkline2 = 0
					  }	
			if(d3.select("#myCheckbox3").property("checked")){
						  checkline3 = 1
					  } else {
						  checkline3 = 0
					  }	
			update2()
		  }
		  
		  update2()
			  
		  function update2(){
			var dateUpdate = document.getElementById("date2").value
			d3.select("#visual2").selectAll("*").remove();
		  // append the svg object to the body of the page
			  var svg = d3.select("#visual2")
			.append("svg")
			  .attr("width", width + margin.left + margin.right)
			  .attr("height", height + margin.top + margin.bottom)
			.append("g")
			  .attr("transform",
					"translate(" + margin.left + "," + margin.top + ")");
		  //Read the data
			d3.csv("https://raw.githubusercontent.com/hoaluan97/dataviz-electricite-conso/master/Individual_Household_Electric_Power_Consumption.csv",
	  
			  // When reading the csv, I must format variables:
			  function(d){
	  
				if(d.Date==dateUpdate){
				  return { Date : d3.timeParse("%d/%m/%Y")(d.Date),
						  Time : d3.timeParse("%H:%M:%S")(d.Time),
						  date : d3.timeParse("%d/%m/%Y %H:%M:%S")(d.Date +" "+ d.Time),
						  Global_active_power : d.Global_active_power,
						  Sub_metering_1 : d.Sub_metering_1,
						  Sub_metering_2 : d.Sub_metering_2,
						  Sub_metering_3 : d.Sub_metering_3,
						  Sub_metering_other : d.Sub_metering_other }
				  }
			  },
	  
			  // Now I can use this dataset:
			  function(data) {
				// Add X axis --> it is a date format
				console.log(data.length)
				// This allows to find the closest X index of the mouse:
						var bisect = d3.bisector(function(d) { return d.date; }).left;
			  
				  var focus = svg.append('g')
				  .append('circle')
				  .style("fill", "#47ff6f")
				  .attr("stroke", "black")
				  .attr('r', 8.5)
				  .style("opacity", 0)
				
				var focusText = svg.append('g')
					.append('text')
				  .style("opacity", 0)
				  .attr("text-anchor", "left")
				  .attr("alignment-baseline", "middle")
				
				var rayon = 1.5
				
				
				var x = d3.scaleTime()
				  .domain(d3.extent(data, function(d) { return d.date; }))
				  .range([ 0, width ]);
	  
				xAxis = svg.append("g")
				  .attr("transform", "translate(0," + height + ")")
				  .call(d3.axisBottom(x));
	  
				// Add Y axis
				var y = d3.scaleLinear()
				  .domain([0, d3.max(data, function(d) { return +Math.max(d.Sub_metering_1,
										   d.Sub_metering_2,
										   d.Sub_metering_3); })])
				  .range([ height, 0 ]);
				yAxis = svg.append("g")
				  .call(d3.axisLeft(y));
	  
				// Add a clipPath: everything out of this area won't be drawn.
				var clip = svg.append("defs").append("svg:clipPath")
					.attr("id", "clip")
					.append("svg:rect")
					.attr("width", width )
					.attr("height", height )
					.attr("x", 0)
					.attr("y", 0)
						  .on('mouseover', mouseover)
					.on('mousemove', mousemove)
					.on('mouseout', mouseout);
	  
				// Add brushing
				var brush = d3.brushX()                
					.extent( [ [0,0], [width,height] ] ) 
					.on("end", updateChart)
	  
				
				
				// Create the line variable: where both the line and the brush take place
				var line = svg.append('g')
				  .attr("clip-path", "url(#clip)")
					.on('mouseover', mouseover)
				  .on('mousemove', mousemove)
				  .on('mouseout', mouseout);
						  
				// Add the line
				var areaGenerator = d3.area()
				.x(function(d) { return x(d.date) })
				.y0(y(0))
				.y1(function(d) { return y(d.Sub_metering_other) })
				
				var areaGenerator1 = d3.area()
				.x(function(d) { return x(d.date) })
				.y0(y(0))
				.y1(function(d) { return y(d.Sub_metering_1) })
				var areaGenerator2 = d3.area()
				.x(function(d) { return x(d.date) })
				.y0(y(0))
				.y1(function(d) { return y(d.Sub_metering_2) })
				var areaGenerator3 = d3.area()
				.x(function(d) { return x(d.date) })
				.y0(y(0))
				.y1(function(d) { return y(d.Sub_metering_3) })
				
				if(checkline1){
				  line.append("path")
					.datum(data)
					.attr("class", "line1")
					.attr("fill", "#fd243e")
					.attr("fill-opacity", .3)
					.attr("stroke", "#006c93")
					.attr("stroke-width", 2)
					.attr("d", areaGenerator1)
	  
				  line.selectAll("myCircles")
				  .data(data)
				  .enter()
				  .append("circle")
				  .attr("class", "circle1")
				  .attr("fill", "red")
				  .attr("stroke", "none")
				  .attr("cx", function(d) { return x(d.date) })
				  .attr("cy", function(d) { return y(d.Sub_metering_1) })
				  .attr("r", rayon)
				}
				if(checkline2){
				  line.append("path")
					.datum(data)
					.attr("class", "line2")
					.attr("fill", "#24fd3a")
					.attr("fill-opacity", .3)
					.attr("stroke", "#006c93")
					.attr("stroke-width", 2)
					.attr("d", areaGenerator2)
	  
				  line.selectAll("myCircles")
					.data(data)
					.enter()
					.append("circle")
					.attr("class", "circle2")
					.attr("fill", "green")
					.attr("stroke", "none")
					.attr("cx", function(d) { return x(d.date) })
					.attr("cy", function(d) { return y(d.Sub_metering_2) })
					.attr("r", rayon)
				}
				
				if(checkline3){
				  line.append("path")
					.datum(data)
					.attr("class", "line3")
					.attr("fill", "#2453fd")
					.attr("fill-opacity", .3)
					.attr("stroke", "#006c93")
					.attr("stroke-width", 2)
					.attr("d", areaGenerator3)
	  
				  line.selectAll("myCircles")
					.data(data)
					.enter()
					.append("circle")
					.attr("class", "circle3")
					.attr("fill", "blue")
					.attr("stroke", "none")
					.attr("cx", function(d) { return x(d.date) })
					.attr("cy", function(d) { return y(d.Sub_metering_3) })
					.attr("r", rayon)
				}
	  
				// Add the brushing
				line
				  .append("g")
					.attr("class", "brush")
					.call(brush);
	  
				// A function that set idleTimeOut to null
				var idleTimeout
				function idled() { idleTimeout = null; }
			  
					// What happens when the mouse move -> show the annotations at the right positions.
				function mouseover() {
				  focus.style("opacity", 1)
				  focusText.style("opacity",1)
				}
	  
				function mousemove() {
				  // recover coordinate we need
				  var x0 = x.invert(d3.mouse(this)[0]);
				  var i = bisect(data, x0, 1);
				  selectedData = data[i]
				  focus
					.attr("cx", x(selectedData.date))
					.attr("cy", y(Math.max(selectedData.Sub_metering_1,
										   selectedData.Sub_metering_2,
										   selectedData.Sub_metering_3)))
				  focusText
					.html("x:" + d3.timeFormat("%H:%M:%S")(selectedData.Time )+ "  -  " + "y:" + Math.max(selectedData.Sub_metering_1,
										   selectedData.Sub_metering_2,
										   selectedData.Sub_metering_3))
					.attr("x", x(selectedData.date)+15)
					.attr("y", y(Math.max(selectedData.Sub_metering_1,
										   selectedData.Sub_metering_2,
										   selectedData.Sub_metering_3)))
				  }
				function mouseout() {
				  focus.style("opacity", 0)
				  focusText.style("opacity", 0)
				}
			  
				  d3.csv("https://raw.githubusercontent.com/hoaluan97/dataviz-electricite-conso/master/Mean_24h_ByMinute_FilterYearMonthDay.csv",
				  
				  function(d){
					if(d.Year==dateUpdate.split("/")[2] && d.Month==dateUpdate.split("/")[1]){
					  return { Date2 : d3.timeParse("%d/%m/%Y")(dateUpdate),
							  Time2 : d3.timeParse("%d/%m/%Y %H:%M:%S")(dateUpdate 
																		+" "+d.Hour_of_Day 
																				  + ":" + d.Minute_of_Hour
																				  + ":00" ),
							  Global_active_power_Mean : d.Global_active_power_Mean,
							  Sub_metering_1_Mean : d.Sub_metering_1_Mean,
							  Sub_metering_2_Mean : d.Sub_metering_2_Mean,
							  Sub_metering_3_Mean : d.Sub_metering_3_Mean,
							  Sub_metering_other_Mean : d.Sub_metering_other_Mean }
					  }
				  }, function(data2){
					  console.log(checkline1)
					  if(checkline1){
					  line.append("path")
						.datum(data2)
						.attr("class", "lineMean1")
						.attr("fill", "none")
						.attr("stroke", "FireBrick ")
						.attr("stroke-width", 1)
						.attr("d", d3.line()
							 .x(function(d,i){return x(d.Time2)})
							 .y(function(d,i){return y(d.Sub_metering_1_Mean)}))
					}
					  if(checkline2){
					line.append("path")
					  .datum(data2)
					  .attr("class", "lineMean2")
					  .attr("fill", "none")
					  .attr("stroke", "ForestGreen ")
					  .attr("stroke-width", 1)
					  .attr("d", d3.line()
						   .x(function(d,i){return x(d.Time2)})
						   .y(function(d,i){return y(d.Sub_metering_2_Mean)}))
					}
					if(checkline3){
					line.append("path")
					  .datum(data2)
					  .attr("class", "lineMean3")
					  .attr("fill", "none")
					  .attr("stroke", "mediumblue ")
					  .attr("stroke-width", 1)
					  .attr("d", d3.line()
						   .x(function(d,i){return x(d.Time2)})
						   .y(function(d,i){return y(d.Sub_metering_3_Mean)}))
					}
				  })
	  
				// A function that update the chart for given boundaries
				function updateChart() {
				  
				  line.selectAll('.circle1').remove()
				  line.selectAll('.circle2').remove()
				  line.selectAll('.circle3').remove()
				  // What are the selected boundaries?
				  extent = d3.event.selection
	  
				  // If no selection, back to initial coordinate. Otherwise, update X axis domain
				  if(!extent){
					if (!idleTimeout) return idleTimeout = setTimeout(idled, 350); // This allows to wait a little bit
					x.domain([ 4,8])
				  }else{
					x.domain([ x.invert(extent[0]), x.invert(extent[1]) ])
					line.select(".brush").call(brush.move, null) 
				  }
	  
				  // Update axis and line position
				  xAxis.transition().duration(1000).call(d3.axisBottom(x))
				  if(checkline1){
					line.select('.line1')
						.transition()
						.duration(1000)
						.attr("d", areaGenerator1)
	  
					line.select('.lineMean1')
						.transition()
						.duration(1000)
						.attr("d", d3.line()
							 .x(function(d,i){return x(d.Time2)})
							 .y(function(d,i){return y(d.Sub_metering_1_Mean)}))
					
					line.selectAll("myCircles")
					  .data(data)
					  .enter()
					  .append("circle")
					  .attr("class", "circle1")
					  .attr("fill", "red")
					  .attr("stroke", "none")
					  .attr("cx", function(d) { return x(d.date) })
					  .attr("cy", function(d) { return y(d.Sub_metering_1) })
					  .attr("r", 2)
				  }
				  if(checkline2){
					line.select('.line2')
						.transition()
						.duration(1000)
						.attr("d", areaGenerator2)
					line.select('.lineMean2')
						.transition()
						.duration(1000)
						.attr("d", d3.line()
							 .x(function(d,i){return x(d.Time2)})
							 .y(function(d,i){return y(d.Sub_metering_2_Mean)}))
					line.selectAll("myCircles")
					  .data(data)
					  .enter()
					  .append("circle")
					  .attr("class", "circle2")
					  .attr("fill", "green")
					  .attr("stroke", "none")
					  .attr("cx", function(d) { return x(d.date) })
					  .attr("cy", function(d) { return y(d.Sub_metering_2) })
					  .attr("r", rayon)
				   }
				  
				  if(checkline3){
					line.select('.line3')
						.transition()
						.duration(1000)
						.attr("d", areaGenerator3)
	  
					line.select('.lineMean3')
						.transition()
						.duration(1000)
						.attr("d", d3.line()
							 .x(function(d,i){return x(d.Time2)})
							 .y(function(d,i){return y(d.Sub_metering_3_Mean)}))
					line.selectAll("myCircles")
					.data(data)
					.enter()
					.append("circle")
					.attr("class", "circle3")
					.attr("fill", "blue")
					.attr("stroke", "none")
					.attr("cx", function(d) { return x(d.date) })
					.attr("cy", function(d) { return y(d.Sub_metering_3) })
					.attr("r", 2)
				  }
				  
				  
				  
				  
				  
				  
				  
				}
	  
				// If user double click, reinitialize the chart
				svg.on("dblclick",function(){
				  x.domain(d3.extent(data, function(d) { return d.date; }))
				  xAxis.transition().call(d3.axisBottom(x))
				  if(checkline1){
					line.select('.line1')
						.transition()
						.duration(1000)
						.attr("d", areaGenerator1)
	  
					line.select('.lineMean1')
						.transition()
						.duration(1000)
						.attr("d", d3.line()
							 .x(function(d,i){return x(d.Time2)})
							 .y(function(d,i){return y(d.Sub_metering_1_Mean)}))
					
					line.selectAll("myCircles")
					  .data(data)
					  .enter()
					  .append("circle")
					  .attr("class", "circle1")
					  .attr("fill", "red")
					  .attr("stroke", "none")
					  .attr("cx", function(d) { return x(d.date) })
					  .attr("cy", function(d) { return y(d.Sub_metering_1) })
					  .attr("r", 2)
				  }
				  if(checkline2){
					line.select('.line2')
						.transition()
						.duration(1000)
						.attr("d", areaGenerator2)
					line.select('.lineMean2')
						.transition()
						.duration(1000)
						.attr("d", d3.line()
							 .x(function(d,i){return x(d.Time2)})
							 .y(function(d,i){return y(d.Sub_metering_2_Mean)}))
					line.selectAll("myCircles")
					  .data(data)
					  .enter()
					  .append("circle")
					  .attr("class", "circle2")
					  .attr("fill", "green")
					  .attr("stroke", "none")
					  .attr("cx", function(d) { return x(d.date) })
					  .attr("cy", function(d) { return y(d.Sub_metering_2) })
					  .attr("r", rayon)
				   }
				  
				  if(checkline3){
					line.select('.line3')
						.transition()
						.duration(1000)
						.attr("d", areaGenerator3)
	  
					line.select('.lineMean3')
						.transition()
						.duration(1000)
						.attr("d", d3.line()
							 .x(function(d,i){return x(d.Time2)})
							 .y(function(d,i){return y(d.Sub_metering_3_Mean)}))
					line.selectAll("myCircles")
					.data(data)
					.enter()
					.append("circle")
					.attr("class", "circle3")
					.attr("fill", "blue")
					.attr("stroke", "none")
					.attr("cx", function(d) { return x(d.date) })
					.attr("cy", function(d) { return y(d.Sub_metering_3) })
					.attr("r", 2)
				  }
				});
			  
				  
	  
			})
			
			
			
		  }
	  
	  
	  
		</script>
		<script src="script3.js"></script>
		<script src="script4.js"></script>

	</body>
</html>